# 原則

## スタンス

- ユーザの指示が誤っている可能性を常に念頭に置く
    - 誤っている可能性とは、つまりユーザの指示通りに作業しても期待する結果が得られないかもしれないということ
    - 作業前には必ず自ら状況を把握し、作業の方向性に問題がないことを確認する


## 作業手順

- 作業対象のディレクトリやプロジェクトに`CLAUDE.md`がある場合、探索や実装の前に必ず最初に読むこと
- 作業が上手く進まない場合、局所解に陥らないよう、早期かつ頻繁に軌道修正を行う
- 成功の見込みが薄い状態でやみくもに作業を行わない
- 分かっていることと分からないことを整理し、不足している情報があればユーザに求める
- 判断に迷う場合には独断で進まず、必ずユーザに相談する


## Bash

- エージェントの設定で許可されている（permissions:allow）コマンドを優先的に使用する
- 特に参照系のコマンドのみを使う調査においては、明確に許可されたコマンドのみを使い、調査が滞らないことを重視する
- 許可されていないコマンドの実行許可を申請する前に、許可されたコマンドで代替できないか検討する

### シェル演算子・パイプ・リダイレクト

- Claude Codeは `&&` などのシェル演算子を認識するため、`Bash(safe-cmd *)`のようなプレフィックス一致ルールでは、`safe-cmd && other-cmd`コマンドの実行許可が与えられない
- これに留意し、許可されたコマンドしか使っていないのに、シェル演算子を使うことでユーザの許可が必要になる事態は避けること
- なお、パイプ (`|`) やリダイレクト (`>`, `2>/dev/null`) を含む場合も同様の挙動になるため、シェル演算子同様に可能な限り使用しない


## 状況報告

- 予期せぬ問題が発生した場合などには速やかにユーザに報告し判断を仰ぐ
- ユーザへの状況報告においては以下を整理し、基本的に客観的な事実のみ伝える
    - 発生している問題
    - 分かっていること
    - 分からないこと
    - 試したこと
- 原因の推測などを報告に含めても良いが、推測であって事実でないことは必ず明示する


## 設計

- ユーザから提示された要件を徹底的に確認する
- 不足している、あるいは曖昧な要件がなくなるまで、ユーザに質問を繰り返す


## 実装

- 明確な実装計画が準備されていない段階では、実装に着手しない
- 原則として、t_wada氏やKent Beck氏が提唱する手法に則り、TDDに実装する
    - Red - Green - Refactor を繰り返して実装を進める
- 変更を加える前に、必ず既存のコードを読んで理解する
- 変更を加えた後は、必ずテストを実行してデグレがないことを確認する

## 実行環境

- 言語のRuntime（JVMやnodeなど）はmiseで管理されている
- Runtimeのバージョンなどを切り替えたいときには、miseで操作すること

